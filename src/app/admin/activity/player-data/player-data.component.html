<div [@routerTransition]>
  <div class="kt-content  kt-grid__item kt-grid__item--fluid kt-grid kt-grid--hor">
    <div class="kt-subheader kt-grid__item">
      <div [class]="containerClass">
        <div class="kt-subheader__main">
          <a id="aaa" href=""> </a>
          <h3 class="kt-subheader__title">
            <span>{{"ActivityData" | localize}}</span>
          </h3>
          <span class="kt-subheader__separator kt-subheader__separator--v"></span>
          <span class="kt-subheader__desc">
            {{"PlayerDataManage" | localize}}
          </span>
        </div>
        <div class="kt-subheader__toolbar">
          <div class="kt-subheader__wrapper">
            <button type="button" class="btn btn-primary" (click)="goExport()" [buttonBusy]="exportLoading">
              <i class="icon-excel"></i>
              {{l('export')}}</button>
          </div>
        </div>
      </div>
    </div>

    <div [class]="containerClass + ' kt-grid__item kt-grid__item--fluid'">
      <div class="kt-portlet kt-portlet--mobile">
        <div class="kt-portlet__body">
          <div class="row">
            <form class="horizontal-form" autocomplete="off">
              <div class="kt-form kt-form--label-align-right">
                <div class="row align-items-center m--margin-bottom-10">
                  <div class="col-xl-3">
                    <div class="form-group kt-form__group align-items-center">
                      <label>{{l('userNickName')}}</label>
                      <div class="input-group">
                        <input (keyup.enter)="getPlayerDataList()" [(ngModel)]="filterText" name="filterText" autoFocus class="form-control kt-input"
                          type="text">
                        <!-- <span class="input-group-btn">
                        <button (click)="getPlayerDataList()" class="btn btn-primary" type="submit">
                          <i class="icon-sousuo-sousuo"></i>
                        </button>
                      </span> -->
                      </div>
                    </div>
                  </div>
                  <div class="col-3" style="position:relative;">
                    <div class="form-group kt-form__group align-items-center">
                      <label>{{l('gameTime')}}</label>
                      <date-range-picker name="SampleDateRangePicker" [showButton]="false" [needInitDate]="true"
                        rangeMode="history" (buttonEmit)="getPlayerDataList()" [(startDate)]="StartTime"
                        [(endDate)]="EndTime">
                      </date-range-picker>
                    </div>
                  </div>
                  <div class="col-2">
                    <div class="form-group kt-form__group align-items-center">
                      <label>{{l('activityName')}}</label>
                      <div class="input-group">
                        <select class="form-control" [(ngModel)]="ActivityId" name="metaTypeSelect2">
                          <option value="">{{l('AllTypes')}}</option>
                          <option [value]="item.id" *ngFor="let item of ActivityList">{{item.name}}</option>
                        </select>
                      </div>
                    </div>
                  </div>
                  <div class="col-2">
                    <div class="form-group kt-form__group align-items-center">
                      <label>&nbsp;</label>
                      <div class="input-group">
                        <button type="button" class="btn btn-primary" [buttonBusy]="primengTableHelper.isLoading"
                          (click)="getPlayerDataList()">
                          <i class="la la-refresh"></i>
                          {{l("search")}}
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>
          </div>
          <div class="row align-items-center">
            <!--<Primeng-Datatable-Start>-->
            <div class="primeng-datatable-container" [busyIf]="primengTableHelper.isLoading">
              <!-- resizableColumns="primengTableHelper.resizableColumns" -->
              <p-table #dataTable (onLazyLoad)="getPlayerDataList($event)" [value]="primengTableHelper.records"
                [rows]="primengTableHelper.defaultRecordsCountPerPage" [paginator]="false" [lazy]="true"
                [resizableColumns]="primengTableHelper.resizableColumns" [responsive]="primengTableHelper.isResponsive">
                <ng-template pTemplate="header">
                  <tr>
                    <th style="width:5%">{{l('Actions')}}</th>
                    <th style="width:5%">{{l('RecordId')}}</th>
                    <th>{{l('headImage')}}</th>
                    <th>{{l('UserName')}}</th>
                    <th>{{l('gender')}}</th>
                    <th>{{l('city')}}</th>
                    <th>{{l('province')}}</th>
                    <th>{{l('activityName')}}</th>
                    <th style="width:5%">{{l('from')}}</th>
                    <th>{{l('gameTime')}}</th>
                    <th>{{l('gameName')}}</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-record let-i="rowIndex">
                  <tr [pSelectableRow]="record" [attr.trid]="record.id">
                    <td>
                      <div class="btn-group dropdown" dropdown normalizePosition>
                        <button class="btn btn-sm btn-primary" (click)="goDetail(record)">
                          {{l("detail")}}
                        </button>
                      </div>
                    </td>
                    <td style="width:5%"> {{transIndex(i)}}</td>
                    <td>
                      <img [src]="fixFileUrl(record.headimgurl)" />
                    </td>
                    <td>
                      <span>{{record.nickname}}</span>
                    </td>
                    <td>
                      <span *ngIf="record.sex==1">{{l('male')}}</span>
                      <span *ngIf="record.sex==2">{{l('female')}}</span>
                    </td>
                    <td>
                      <span>{{record.city}}</span>
                    </td>
                    <td>
                      <span>{{record.province}}</span>
                    </td>
                    <td>
                      <span [title]="record.activityName">{{record.activityName}}</span>
                    </td>
                    <td>
                      <span *ngIf="record.snsType==0" [title]="l('Taobao')">{{l('Taobao')}}</span>
                      <span *ngIf="record.snsType==1" [title]="l('WeChat')">{{l('WeChat')}}</span>
                      <span *ngIf="record.snsType==2" [title]="l('Others')">{{l('Others')}}</span>
                    </td>
                    <td>
                      <span>{{record.startTime | date : "yyyy/MM/dd"}}</span>
                    </td>
                    <td>
                      <span>{{record.softwareName}}</span>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage" let-records>
                  <tr *ngIf="primengTableHelper.records">
                    <td colspan="11">
                      <img class="emptymessage" src="/assets/common/images/placeholder/deviceHolder.png" />
                    </td>
                  </tr>
                </ng-template>
              </p-table>
              <div class="primeng-paging-container">
                <p-paginator [rows]="primengTableHelper.defaultRecordsCountPerPage" #paginator
                  (onPageChange)="getPlayerDataList($event)" [totalRecords]="primengTableHelper.totalRecordsCount"
                  [rowsPerPageOptions]="primengTableHelper.predefinedRecordsCountPerPage">
                </p-paginator>
                <span class="total-records-count">
                  {{l('TotalRecordsCount', primengTableHelper.totalRecordsCount)}}
                </span>
              </div>
            </div>
            <!--<Primeng-Datatable-End>-->
          </div>
        </div>
      </div>
    </div>

    <playerDataDetailModal #playerDataDetailModal></playerDataDetailModal>

  </div>
</div>